define(["jquery","underscore","backbone","leaflet","./LayerModel"],function(t,e,a,s,i){var n=i.extend({initializeModel:function(){"undefined"==typeof this.attributes.wrap&&this.set("wrap",!0)},setData:function(t){t=this.geoJson(t),this.set("mapLayer",t),this.handleResult()},loadData:function(e){this.setLoading(!0);var a=this;t.ajax({dataType:"json",url:this.attributes.baseurl+"/"+this.attributes.path,success:function(t){a.setLoading(!1),e(a.geoJson(t))},error:function(){console.log("error loading geojson layer"),a.setLoading(!1)}})},geoJson:function(t){return L.geoJson(t,{coordsToLatLng:e.bind(this.coordsToLatLng,this),pointToLayer:e.bind(this.pointToLayer,this),className:this.getClassName(),style:this.getLayerStyle()})},getClassName:function(){return"map-layer map-layer-"+this.id+" map-layer-type-"+this.attributes.type},pointToLayer:function(t,e){var a="undefined"!=typeof t.properties.style?t.properties.style:this.attributes.layerStyle;return new L.circleMarker(e,a)},coordsToLatLng:function(t){var e=t[0],a=t[1];return this.attributes.wrap&&e<0?L.latLng(a,e+360):L.latLng(a,e)},updateMapLayerStyle:function(){"function"==typeof this.attributes.mapLayer.setStyle&&this.attributes.mapLayer.setStyle(this.attributes.mapLayer.options.style)}});return n});