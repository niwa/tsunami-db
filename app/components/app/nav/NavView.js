define(["jquery","underscore","backbone","bootstrap","text!./nav.html"],function(e,t,i,a,n){return i.View.extend({events:{"click .home-link":"handleHomeLink","click .nav-link":"handleNavLink"},initialize:function(){this.render(),this.listenTo(this.model,"change:path",this.handleRouteChange),this.listenTo(this.model,"change:route",this.handleRouteChange)},render:function(){return this.$el.html(t.template(n)({t:this.model.getLabels(),navitems:t.map(this.model.getNavItems(),function(e){return e.active=this.isItemActive(e),e.class=e.active?" active":"",e.class+=e.navitems?" nav-group":"",e.navitems=!!e.navitems&&t.map(e.navitems,function(e){return e.active=this.isItemActive(e),e.class=e.active?" active":"",e},this),e},this)})),this},isItemActive:function(e){var i=this.model.getActiveRoute(),a=this.model.getActivePath();switch(e.type){case"component":return e.route===i&&"share"!==a;case"group":return t.reduce(e.navitems,function(e,t){return e||this.isItemActive(t)},!1,this);case"list":case"page":return e.route===i&&e.id===a;case"modal":return e.id===a}},handleHomeLink:function(t){t.preventDefault(),this.$el.trigger("homeLink"),e("#navbar-collapse").collapse("hide")},handleNavLink:function(i){i.preventDefault(),i.stopPropagation();var a=e(i.target).data("id"),n=e(i.target).data("route"),s=e(i.target).data("type");if("group"===s){var r=t.findWhere(this.model.getNavItems(),{id:a}),o=r.navitems[0];a=o.id,n=o.route,s=o.type}this.$el.trigger("navLink",{target:i.target,id:a,route:n,type:s}),e("#navbar-collapse").collapse("hide")},handleRouteChange:function(){this.render()}})});